# π“ λ°±μ—”λ“ μ—”λ“ν¬μΈνΈ ν•λμ— λ³΄κΈ°

μ΄ λ¬Έμ„λ” `/backend` ν΄λ”μ—μ„ μ •μλ FastAPI μ—”λ“ν¬μΈνΈλ¥Ό μ²μ λ³΄λ” μ‚¬λλ„ μ΄ν•΄ν•κΈ° μ‰½κ² μ„¤λ…ν•©λ‹λ‹¤. νΉν PDF μΌκ΄„ μ²λ¦¬μ— μ‚¬μ©λ **LangGraph** νμ΄ν”„λΌμΈμ΄ μ–΄λ–¤ μ—­ν• μ„ ν•λ”μ§€ μ§‘μ¤‘μ μΌλ΅ λ‹¤λ£Ήλ‹λ‹¤.

---

## κΈ°λ³Έ URL κµ¬μ΅°

- λ…ΈνΈλ¶ κ΄€λ ¨ κΈ°λ¥: `/api/notebooks`
- PDF μΌκ΄„ μ²λ¦¬ κΈ°λ¥: `/api/batch-process-pdfs`

μ•„λ ν‘λ” κ° μ—”λ“ν¬μΈνΈμ μ£Όμ” λ™μ‘μ„ κ°„λ‹¨ν μ •λ¦¬ν• κ²ƒμ…λ‹λ‹¤.

| κ²½λ΅ | λ©”μ„λ“ | μ„¤λ… |
|------|-------|------|
| `/api/notebooks` | `GET` | λ¨λ“  λ…ΈνΈλ¶ λ©λ΅μ„ κ°€μ Έμµλ‹λ‹¤. `skip`κ³Ό `limit`μΌλ΅ νμ΄μ§€λ¥Ό μ΅°μ ν•  μ μμµλ‹λ‹¤. |
| `/api/notebooks/search` | `GET` | μ λ©μ— νΉμ • λ‹¨μ–΄κ°€ ν¬ν•¨λ λ…ΈνΈλ¶μ„ μ°Ύμµλ‹λ‹¤. |
| `/api/notebooks/cache/clear` | `POST` | λ…ΈνΈλ¶ μ΅°ν κ²°κ³Όλ¥Ό μΊμ‹ν–λ‹¤λ©΄ μ΄λ¥Ό μ§€μ›λ‹λ‹¤. |
| `/api/notebooks/admin/performance-stats` | `GET` | λ°μ΄ν„°λ² μ΄μ¤ ν†µκ³„μ™€ μΊμ‹ μ‚¬μ© μ •λ³΄λ¥Ό ν™•μΈν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}` | `GET` | ν• λ…ΈνΈλ¶μ μ „μ²΄ μ •λ³΄λ¥Ό κ°€μ Έμµλ‹λ‹¤. `summary_only=true`λ¥Ό μ£Όλ©΄ μ”μ•½λ§ λ°ν™λ©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}` | `PUT` | μ λ©μ΄λ‚ μ„¤λ…μ„ μμ •ν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}` | `DELETE` | λ…ΈνΈλ¶κ³Ό κ·Έ μ•μ λ°μ΄ν„°λ¥Ό λ¨λ‘ μ‚­μ ν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}/chapters` | `GET` | ν•΄λ‹Ή λ…ΈνΈλ¶μ μ±•ν„° λ©λ΅μ„ μ΅°νν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}/content` | `GET` | νΉμ • μ±•ν„°μ λ¬Έμ„ λ‚΄μ©μ„ κ°€μ Έμµλ‹λ‹¤. `path` νλΌλ―Έν„°λ΅ μ±•ν„° λ²νΈλ¥Ό μ§€μ •ν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}/structure` | `GET` | μ±•ν„°μ™€ μ—°κ²°λ νμΌΒ·ν΄λ” κµ¬μ΅°λ¥Ό ν™•μΈν•©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}/content/{chapter_number}/generate-ai-notes` | `POST` | μ΄λ―Έ μ΅΄μ¬ν•λ” μ±•ν„° λ‚΄μ©μΌλ΅ AI λ…ΈνΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤. μ‘μ—…μ€ λ°±κ·ΈλΌμ΄λ“μ—μ„ μ§„ν–‰λ©λ‹λ‹¤. |
| `/api/notebooks/{notebook_id}/upload-and-create-chapter` | `POST` | PDFλ¥Ό μ—…λ΅λ“ν•λ©΄ ν…μ¤νΈλ¥Ό λ¶„μ„ν•΄ μƒ μ±•ν„°λ¥Ό λ§λ“¤μ–΄ μ €μ¥ν•©λ‹λ‹¤. |
| `/api/batch-process-pdfs/` | `POST` | μ—¬λ¬ PDFλ¥Ό ν• λ²μ— μ—…λ΅λ“ν•μ—¬ LangGraph νμ΄ν”„λΌμΈμΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤. λ°ν™λλ” `run_id`λ΅ μ§„ν–‰ μƒν™©μ„ μ΅°νν•  μ μμµλ‹λ‹¤. |
| `/api/batch-process-pdfs/logs/{run_id}` | `GET` | LangGraph μ²λ¦¬ κ³Όμ •μ—μ„ μƒμ„±λ λ΅κ·Έλ¥Ό ν™•μΈν•©λ‹λ‹¤. |
| `/api/batch-process-pdfs/progress/{task_id}` | `GET` | νμΌλ³„ ν„μ¬ μ²λ¦¬ λ‹¨κ³„λ¥Ό μ΅°νν•©λ‹λ‹¤. |
| `/api/batch-process-pdfs/tasks` | `GET` | μ§„ν–‰ μ¤‘μΈ λ¨λ“  μ‘μ—… λ©λ΅μ„ λ΄…λ‹λ‹¤. |

---

## LangGraph νμ΄ν”„λΌμΈ μ†κ°

PDF μ—¬λ¬ κ°λ¥Ό λ™μ‹μ— λ¶„μ„ν•  λ•λ” `graph_processor.py`μ— μ •μλ LangGraph μ›ν¬ν”λ΅λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. μ΄ νμ΄ν”„λΌμΈμ€ λ‹¤μ λ„¤ λ‹¨κ³„λ΅ κµ¬μ„±λ©λ‹λ‹¤.

1. **start_processing** β€“ μ—…λ΅λ“ν• PDFμ—μ„ ν…μ¤νΈλ¥Ό μ¶”μ¶ν•©λ‹λ‹¤.
2. **analyze_overall_structure** β€“ μ¶”μ¶ν• ν…μ¤νΈλ¥Ό λ¨λ‘ λ¨μ•„ λ…ΈνΈλ¶ μ λ©κ³Ό μ±•ν„° κµ¬μ„±μ„ μ μ•ν•©λ‹λ‹¤.
3. **generate_chapter_content** β€“ κ° μ±•ν„°λ³„λ΅ μ„Έλ¶€ λ‚΄μ©μ„ μƒμ„±ν•©λ‹λ‹¤. μ”μ•½, ν•µμ‹¬ κ°λ…, ν€΄μ¦ λ“±μ΄ μ΄ λ‹¨κ³„μ—μ„ λ§λ“¤μ–΄μ§‘λ‹λ‹¤.
4. **finish_processing** β€“ μƒμ„±λ λ‚΄μ©μ„ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥ν•κ³  μµμΆ… κ²°κ³Όλ¥Ό λ°ν™ν•©λ‹λ‹¤.

κ° λ‹¨κ³„μ μ‹¤ν–‰ μƒνƒλ” λ΅κ·Έλ΅ μ €μ¥λλ©°, `/api/batch-process-pdfs/logs/{run_id}`λ¥Ό ν†µν•΄ ν™•μΈν•  μ μμµλ‹λ‹¤. νμ΄ν”„λΌμΈ λ•λ¶„μ— μ—¬λ¬ λ¬Έμ„λ¥Ό μμ°¨μ μΌλ΅ λ¶„μ„ν•κ³  ν• λ²μ— λ…ΈνΈλ¶μ„ μ™„μ„±ν•  μ μμµλ‹λ‹¤.

### νμ΄ν”„λΌμΈ νλ¦„ λ‹¤μ΄μ–΄κ·Έλ¨

```
PDF μ—…λ΅λ“
   β”‚
   β–Ό
start_processing
   β”‚
   β–Ό
analyze_overall_structure
   β”‚
   β–Ό
generate_chapter_content
   β”‚
   β–Ό
finish_processing
   β”‚
   β–Ό
λ…ΈνΈλ¶ μ €μ¥ μ™„λ£
```

### μμ‹ μ‹λ‚λ¦¬μ¤

1. `math.pdf`μ™€ `physics.pdf` λ‘ νμΌμ„ `/api/batch-process-pdfs/` λ΅ μ—…λ΅λ“ν•©λ‹λ‹¤.
2. μ„λ²„κ°€ νμΌμ„ λ°›μΌλ©΄ κ° PDFμ—μ„ ν…μ¤νΈλ¥Ό μ¶”μ¶ν•κ³  LangGraph νμ΄ν”„λΌμΈμ„ μ‹μ‘ν•©λ‹λ‹¤.
3. `analyze_overall_structure` λ‹¨κ³„μ—μ„ λ‘ νμΌμ λ‚΄μ©μ„ μ΅°ν•©ν•΄ λ…ΈνΈλ¶ μ λ©κ³Ό μ±•ν„° κµ¬μ΅°λ¥Ό μ μ•ν•©λ‹λ‹¤.
4. `generate_chapter_content` λ‹¨κ³„μ—μ„ κ° μ±•ν„°μ— λ€ν• μ”μ•½κ³Ό ν€΄μ¦κ°€ μƒμ„±λ©λ‹λ‹¤.
5. `finish_processing` λ‹¨κ³„μ—μ„ λ¨λ“  κ²°κ³Όκ°€ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λκ³  μƒλ΅μ΄ λ…ΈνΈλ¶ IDκ°€ μƒμ„±λ©λ‹λ‹¤.
6. μµμΆ…μ μΌλ΅ `/api/notebooks/{notebook_id}`λ¥Ό νΈμ¶ν•μ—¬ μƒμ„±λ λ…ΈνΈλ¶ λ‚΄μ©μ„ λ³Ό μ μμµλ‹λ‹¤.

---

μ΄λ ‡κ² μ •λ¦¬λ μ—”λ“ν¬μΈνΈμ™€ LangGraphμ λ™μ‘ λ°©μ‹μ„ μ°Έκ³ ν•λ©΄ ν”„λ΅μ νΈμ λ°±μ—”λ“ κµ¬μ΅°λ¥Ό μ‰½κ² νμ•…ν•  μ μμµλ‹λ‹¤.
